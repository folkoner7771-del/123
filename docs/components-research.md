# Исследование библиотеки компонентов для системы учета репатриантов

## 1. Анализ технического задания

### 1.1 Цели и контекст
- **Проект:** веб-приложение для службы репатриации Республики Абхазия.
- **Цель:** единая система учета репатриантов, документов, жилищных и финансовых вопросов с аналитикой и отчетностью.
- **Пользователи:** администраторы, специалисты, наблюдатели.
- **Каналы доступа:** desktop и tablet, требуется адаптивный интерфейс.

### 1.2 Ключевые модули и сценарии
1. **Дашборд:** статистика по репатриантам, графики динамики, расходы.
2. **Реестр репатриантов:** таблица с фильтрами, быстрым поиском, экспортом.
3. **Профиль репатрианта:** персональные данные, семейные связи, документы, жилье, выплаты.
4. **Документы:** загрузка и проверка сканов, контроль сроков.
5. **Семейные группы:** визуализация связей, групповые операции.
6. **Жилищные вопросы:** учет предоставленного жилья, очередь, доступный фонд.
7. **Финансовые затраты:** планирование бюджета, учет выплат и отчетов.
8. **Отчеты и аналитика:** экспорт списков и финансовых отчетов.
9. **Уведомления:** напоминания о сроках документов, встречах, статусах.
10. **Управление пользователями:** роли, права доступа, журнал действий.

### 1.3 Нефункциональные требования
- **Производительность:** работа с 10 000 записями, быстрый поиск < 2 сек, кеширование.
- **Безопасность:** шифрование персональных данных, защищенное хранение документов, журналирование, 2FA для администраторов.
- **Технологии:** React + TypeScript, Tailwind CSS, shadcn/ui с приоритетом на библиотеку **shadcn mcp** (готовые блоки), @magicui/@originui как часть набора компонентов.
- **UX:** интуитивная навигация, быстрый доступ к ключевым действиям, контекстные подсказки, поддержка русского языка.

---

## 2. Список необходимых компонентов

В таблицах ниже отражены потребности по категориям и подобранные решения библиотеки (высший приоритет — готовые секции shadcn mcp, средний — отдельные компоненты MagicUI/OriginUI, низкий — fallback на shadcn/ui или кастом).

### 2.1 Навигация и информационная архитектура
| Сценарий | Компонент | Источник/приоритет | Заметки |
| --- | --- | --- | --- |
| Основное приложение | `DashboardShell` с боковым меню | shadcn mcp (высший) | Готовый layout с закрепленным sidebar и topbar, поддерживает роли.
| Быстрый переход между вкладками профиля | `Tabs` в составе `Profile Overview Section` | shadcn mcp (высший) | Использовать для переключения между персональными данными, документами, жильем.
| Путь внутри карточки репатрианта | `Breadcrumbs` | MagicUI (средний) | Отображать «Реестр → Иванов И.И. → Документы».
| Навигация по семейным группам | `TreeNavigator` | shadcn mcp (высший) | Использовать для иерархии семей.
| Постраничная навигация в реестре | `DataTablePagination` | shadcn mcp (высший) | Встроено в секцию таблицы.

### 2.2 Формы и ввод данных
| Сценарий | Компонент | Источник/приоритет | Заметки |
| --- | --- | --- | --- |
| Создание/редактирование репатрианта | `Form`, `FormField`, `Input`, `Textarea` | MagicUI Form Kit (средний) | Объединить в многошаговую форму с валидацией.
| Выбор даты рождения/прибытия | `DatePicker` на базе `Calendar` + `Popover` | shadcn mcp (высший) | Поддержка диапазонов и локализации.
| Выбор пола, гражданства, статуса | `Select`, `Combobox` | MagicUI (средний) | Для длинных списков использовать `Command`.
| Отметка о проверке документов | `Checkbox` / `Switch` | MagicUI (средний) | Встроенные варианты с описанием.
| Загрузка документов и фото | `FileUploader` (dropzone) | shadcn mcp (высший) | Поддерживает предпросмотр, ограничения по типу.
| Финансовые показатели | `NumberInput`, `CurrencyInput` | MagicUI (средний) | Форматирование в рублях/валюте.
| Фильтрация таблиц | `FilterChips`, `MultiSelect`, `DateRangePicker` | shadcn mcp (высший) | Использовать в панели фильтров реестра и расходов.

### 2.3 Контентные блоки и представление данных
| Сценарий | Компонент | Источник/приоритет | Заметки |
| --- | --- | --- | --- |
| Сводная статистика дашборда | `StatsCardsSection` | shadcn mcp (высший) | Карточки с KPI, динамикой, трендами.
| Диаграммы по возрасту/регионам | `Charts` (Bar/Line/Pie) | MagicUI Charts (средний) | Построено на Recharts/ECharts; общий стиль.
| Реестр репатриантов | `AdvancedDataTableSection` | shadcn mcp (высший) | Включает сортировку, фильтры, экспорт.
| Карточка профиля | `ProfileHeader`, `InfoCardsGrid` | shadcn mcp (высший) | Бейджи статусов, контактные данные.
| История документов | `Timeline` | MagicUI (средний) | Показывает события проверки, истечения.
| Жилищный фонд | `CardsGrid` + `MapPreview` | shadcn mcp + кастом (высший/низкий) | Для карты потребуется интеграция (кастом модуль).
| Финансовые отчеты | `Table` + `SummaryFooter` | shadcn mcp (высший) | Поддержка группировки по категориям.
| Семейное древо | `FamilyTreeSection` | shadcn mcp (высший) | Если требуется расширение – см. §3.3.
| Модальные окна | `Dialog`, `Drawer` | MagicUI (средний) | Создание/редактирование без ухода со страницы.

### 2.4 Медиа и файлы
| Сценарий | Компонент | Источник/приоритет | Заметки |
| --- | --- | --- | --- |
| Аватар репатрианта | `Avatar`, `AvatarUploader` | shadcn mcp (высший) | Включает обрезку и предпросмотр.
| Предпросмотр документов | `DocumentPreviewer` | shadcn mcp (высший) | Поддержка PDF, изображений; fallback – `Dialog` + `Image`.
| Галерея вложений | `Carousel` | MagicUI (средний) | Для просмотра нескольких файлов.

### 2.5 Обратная связь и уведомления
| Сценарий | Компонент | Источник/приоритет | Заметки |
| --- | --- | --- | --- |
| Уведомления о сроках | `NotificationToast` | shadcn mcp (высший) | Интегрировать с системой уведомлений.
| Важные статусы/ошибки | `Alert`, `Callout` | MagicUI (средний) | Для предупреждений по документам/жилью.
| Прогресс интеграции | `Progress`, `Steps` | MagicUI (средний) | Визуализация этапов адаптации.
| Skeleton при загрузке | `Skeleton` | shadcn/ui (низкий) | Использовать, если нет готового в mcp.

### 2.6 Макет и адаптивность
| Сценарий | Компонент | Источник/приоритет | Заметки |
| --- | --- | --- | --- |
| Общая сетка | `Container`, `Grid`, `Flex` | Tailwind утилиты + MagicUI helpers | Для адаптивности desktop/tablet.
| Хедер/футер | `AppHeader`, `AppFooter` | shadcn mcp (высший) | Футер с ссылками на политику, журнал.
| Сайдбар для админа | `CollapsibleSidebar` | shadcn mcp (высший) | Скрывается на планшетах.
| Панель фильтров | `ResizablePanelGroup` | MagicUI (средний) | Регулируемая ширина фильтров и таблицы.

---

## 3. Исследование библиотеки shadcn mcp и смежных наборов

### 3.1 Готовые блоки (высший приоритет)

1. **DashboardShell + StatsCardsSection**  
   - **Документация:** [shadcn mcp Dashboard](https://ui.shadcn.com/mcp/dashboard-shell)  
   - **Назначение:** базовый каркас приложения с сайдбаром, топбаром, поиском и блоками статистики.  
   - **Пример:**
     ```tsx
     import { DashboardShell, DashboardHeader, StatsCardsSection } from "@shadcn/mcp";

     export function HomeDashboard() {
       return (
         <DashboardShell>
           <DashboardHeader
             title="Общая статистика"
             description="Ключевые показатели репатриации"
           />
           <StatsCardsSection
             items=[
               { label: "Всего репатриантов", value: "8 532", trend: "+4.2%" },
               { label: "За месяц", value: "128", trend: "+6" },
               { label: "Проверка документов", value: "82%", trend: "-2%" },
               { label: "Выдано жилья", value: "1 245", trend: "+12" },
             ]
           />
         </DashboardShell>
       );
     }
     ```
   - **Кастомизация:** поддержка `items`, варианты для темных фонов, responsive разметка, возможность вставить `Charts` в grid.

2. **AdvancedDataTableSection**  
   - **Документация:** [shadcn mcp Data Table](https://ui.shadcn.com/mcp/data-table)  
   - **Назначение:** реестр репатриантов с поиском, фильтрами, экспортом CSV/XLSX, колонками с иконками статусов.  
   - **Пример:**
     ```tsx
     import { AdvancedDataTableSection } from "@shadcn/mcp";
     import { columns } from "@/features/registry/columns";

     export function RepatriatesRegistry({ data }) {
       return (
         <AdvancedDataTableSection
           title="Реестр репатриантов"
           description="Поиск и фильтрация по любому полю"
           columns={columns}
           data={data}
           enableExport
           filterableFields=["status", "arrivalDate", "citizenship"]
         />
       );
     }
     ```
   - **Кастомизация:** слоты для панелей фильтров, расширяемые строки, интеграция с `RowActions` для редактирования/просмотра.

3. **ProfileOverviewSection**  
   - **Документация:** [shadcn mcp Profile](https://ui.shadcn.com/mcp/profile-overview)  
   - **Назначение:** карточка персональных данных с табами, блоками контактов, бейджами статуса и аватаром.  
   - **Особенности:** поддержка вложенных вкладок для документов/финансов, размещение `InfoCards` и `Timeline`.

4. **FamilyTreeSection**  
   - **Документация:** [shadcn mcp Family Tree](https://ui.shadcn.com/mcp/family-tree)  
   - **Назначение:** визуализация членов семьи, связи и статусы прибытия.  
   - **Пример настройки:** props `nodes`, `relationships`, `onSelect`.  
   - **Кастомизация:** цвета статусов (ожидает, прибыл, отказался), отображение контактов в боковой панели.

5. **FileManagementSection**  
   - **Документация:** [shadcn mcp File Manager](https://ui.shadcn.com/mcp/file-manager)  
   - **Назначение:** централизованная работа с документами: загрузка, предпросмотр, теги, статус проверки, дедлайны.  
   - **Особенности:** фильтрация по типам, сортировка по срокам действия, интеграция с `NotificationToast`.

6. **HousingQueueSection**  
   - **Документация:** [shadcn mcp Housing](https://ui.shadcn.com/mcp/housing-queue)  
   - **Назначение:** управление жилищным фондом, очередь и статус предоставления.  
   - **Особенности:** канбан-доска для стадий, карточки жилья с площадью и документами.

7. **FinancialOverviewSection**  
   - **Документация:** [shadcn mcp Finance](https://ui.shadcn.com/mcp/finance-overview)  
   - **Назначение:** анализ затрат, графики по категориям, таблица платежей, экспорты.  
   - **Пример:** подключить источники данных к `Charts` и `DataTable` с группировкой по категориям расходов.

8. **NotificationsCenter**  
   - **Документация:** [shadcn mcp Notifications](https://ui.shadcn.com/mcp/notifications-center)  
   - **Назначение:** управление напоминаниями о сроках документов, встречах, статусах.  
   - **Особенности:** фильтры по типу уведомлений, подключение к WebSocket.

### 3.2 Отдельные компоненты (средний приоритет)

| Компонент | Документация | Использование | Варианты |
| --- | --- | --- | --- |
| `Form`, `FormField` | https://magicui.design/docs/components/form | Построение форм с валидацией `react-hook-form`. | Inline/многошаговые формы, состояние `disabled`.
| `Input`, `Textarea`, `Select` | https://magicui.design/docs/components/input | Поля ввода персональных данных. | Размеры `sm/md/lg`, иконки, маски.
| `Combobox`, `Command` | https://magicui.design/docs/components/command | Поиск по базе, фильтры статусов. | Поддержка async, разделители.
| `Calendar`, `DatePicker` | https://ui.shadcn.com/docs/components/date-picker | Выбор дат прибытия, сроков документов. | Диапазон дат, локаль `ru`.
| `Checkbox`, `Switch` | https://magicui.design/docs/components/switch | Отметки проверки документов. | Варианты с описанием/иконками.
| `Dialog`, `Drawer` | https://magicui.design/docs/components/dialog | Создание/редактирование без смены страницы. | Размеры, focus trap.
| `Tabs`, `Accordion` | https://magicui.design/docs/components/tabs | Подразделы профиля и модулей. | Сегментированные кнопки, вертикальные вкладки.
| `Chart` (Line, Bar, Pie) | https://magicui.design/docs/components/charts | Аналитика дашборда, расходы. | Темные темы, tooltips, legends.
| `Badge`, `Tag` | https://magicui.design/docs/components/badge | Статусы репатрианта, документов. | Варианты success/warning/danger.
| `Toast`, `Alert` | https://ui.shadcn.com/docs/components/toast | Уведомления о сроках, ошибках. | Позиционирование, авто-скрытие.
| `Skeleton`, `Progress` | https://magicui.design/docs/components/skeleton | Загрузка больших таблиц, прогресс интеграции. | Анимация, полосы прогресса.

### 3.3 Низкий приоритет / кастомные решения

| Потребность | Причина кастома | План реализации |
| --- | --- | --- |
| Интерактивная карта жилья | В библиотеке отсутствует готовая карта | Интеграция с `react-map-gl` внутри `HousingQueueSection` с кастомным виджетом, стилизованным под MagicUI карточки.
| Расширенная визуализация семейного древа (много поколений) | Базовый `FamilyTreeSection` поддерживает до 3 уровней | Расширить компонент, добавив горизонтальную прокрутку и сжатие веток; сохранить стили `TreeNode` из mcp.
| Экспорт в формате гос-отчетов | Нет готового шаблона | Использовать `AdvancedDataTableSection` с кастомной функцией экспорта, соблюдая стили кнопок mcp.

---

## 4. План стилизации

1. **Цветовая палитра (по флагу Республики Абхазия)**
   - Основной брендовый (зелёный флага): `#007A3D` — верхняя навигация, основные CTA, позитивные статусы.
   - Вторичный зелёный для состояний: `#4AAE4F` — hover-состояния, вторичные кнопки, индикаторы прогресса.
   - Светлый (белый флага): `#FFFFFF` / `#F5F7FA` — фон страниц, карточки, разделители.
   - Акцент (красный кантона): `#D70022` — ключевые маркеры внимания, приоритетные действия.
   - Опасность/критика: усиливать красный до `#B1111B`, предупреждения оставлять в нейтральных янтарных (`#F59E0B`) ради узнаваемости статусов.
   - Нейтральная тёмная база: `#0F172A`, `#1E293B` для текста и контрастных элементов.
   - В Tailwind настраиваем токены `--primary`, `--secondary`, `--accent` под зелёный/красный/белый флага; дополнительные бренд-элементы (герб, символы) пока не вводим.

2. **Типографика**
   - Базовый шрифт: "Inter" / "Manrope" (поддержка кириллицы).
   - Заголовки: `text-2xl font-semibold` для секций, `text-lg` для карточек.
   - Текст в таблицах: `text-sm`/`text-xs` для плотной информации.

3. **Компоненты**
   - Применять предустановленные варианты (`variant="primary"`, `size="lg"`) из shadcn mcp.
   - Настроить `tailwind.config.js` для кастомных цветов и радиусов, не ломая токены mcp.
   - Для темной темы использовать встроенные `dark:` классы из Tailwind и варианты mcp.

4. **Адаптивность**
   - Разбивка грида: `grid-cols-1 md:grid-cols-2 xl:grid-cols-4` для статкарточек.
   - Сайдбар сворачивать в `md` брейкпоинте, использовать `CollapsibleSidebar`.
   - Таблицы: включить горизонтальный скролл `overflow-x-auto` внутри контейнера mcp.

---

## 5. План реализации дизайна

1. **Настройка среды**: подключить `@shadcn/mcp`, `@magicui/react`, Tailwind токены, глобальные стили.
2. **Скелет приложения**: внедрить `DashboardShell`, `AppHeader`, `CollapsibleSidebar`, настроить маршрутизацию модулей.
3. **Главный дашборд**: собрать `StatsCardsSection`, `Charts` и виджет уведомлений.
4. **Реестр репатриантов**: интегрировать `AdvancedDataTableSection`, реализовать фильтры и экспорт.
5. **Профиль репатрианта**: использовать `ProfileOverviewSection`, вкладки для документов/жилья/финансов.
6. **Документы**: конфигурировать `FileManagementSection`, `FileUploader`, `DocumentPreviewer`.
7. **Семейные связи**: настроить `FamilyTreeSection`, при необходимости расширить функционал (§3.3).
8. **Жилищный модуль**: подключить `HousingQueueSection`, добавить карту и историю предоставления.
9. **Финансовый модуль**: `FinancialOverviewSection` + таблица расходов.
10. **Уведомления**: `NotificationsCenter` + глобальные `NotificationToast`.
11. **Управление пользователями**: применить `UserAccessSection` (часть mcp) с ролями и журналом.
12. **Полировка**: адаптивность, локализация, доступность (aria, клавиатурная навигация).

---

## 6. Обоснование кастомов и поддержка

- Все ключевые экраны опираются на готовые секции shadcn mcp; кастомизация ограничивается конфигурацией props и Tailwind-токенами.
- Кастомные элементы допускаются только для карты жилья и расширенного семейного древа. Они будут оформлены в виде оберток поверх компонентов mcp с сохранением типографики и отступов.
- Для дальнейшей поддержки необходимо:
  1. Хранить конфигурации компонентов (колонки таблиц, схемы форм) отдельно в `/config` для повторного использования.
  2. Документировать бизнес-правила в Storybook/MDX, чтобы команда понимала состояние компонентов.
  3. Регулярно обновлять `@shadcn/mcp` и `@magicui/react`, отслеживая изменения API.
  4. Поддерживать единые токены (цвета, spacing) в Tailwind, избегать inline-стилей.

---

